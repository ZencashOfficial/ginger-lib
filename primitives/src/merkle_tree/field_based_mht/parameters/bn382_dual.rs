use algebra::{
    fields::bn_382::Fq as BN382Fq,
    biginteger::BigInteger384,
    field_new,
};

use crate::{
    crh::poseidon::BN382FqPoseidonHash,
    FieldBasedMerkleTreePrecomputedZeroConstants,
};

// PoseidonHash("This represents an empty Merkle Root for a BN382FqPoseidonHash based Merkle Tree.")
pub const BN382_DUAL_PHANTOM_MERKLE_ROOT: BN382Fq =
    field_new!(BN382Fq, BigInteger384([
        8979936313940592922,
        10215515058412413971,
        2463279520739337462,
        4275260645336182177,
        15799583494722806682,
        1056984384425758049
    ]));

pub const BN382_DUAL_MHT_POSEIDON_PARAMETERS: FieldBasedMerkleTreePrecomputedZeroConstants<'static, BN382FqPoseidonHash> =
    FieldBasedMerkleTreePrecomputedZeroConstants {
        nodes: &[
            field_new!(BN382Fq, BigInteger384([0, 0, 0, 0, 0, 0])),
            field_new!(BN382Fq, BigInteger384([7636599113261288821, 6557727936151308107, 3241378259940865905, 15871565890065558290, 16630733516914421307, 1324540765431294349])),
            field_new!(BN382Fq, BigInteger384([287727488433006003, 1088464748192281431, 15827020881079220140, 1331775575232289584, 14242619047041217569, 2294212050388026625])),
            field_new!(BN382Fq, BigInteger384([7993457779915725923, 3058943635510122026, 11798068799170575640, 3747175813576786677, 213663719667506195, 2366009504554367300])),
            field_new!(BN382Fq, BigInteger384([10094926679317363223, 12737879176061019736, 10978848528492051076, 8544191473536318673, 14993933841124926991, 1753564439929246431])),
            field_new!(BN382Fq, BigInteger384([6253365645214559243, 3039874498142218772, 14086580511026357838, 60728832917754024, 12440802359123561345, 1868834410540352685])),
            field_new!(BN382Fq, BigInteger384([10244718802795623022, 9073840648386655020, 12838416835650713614, 538879495054185005, 11509536833050651406, 2209499366655055477])),
            field_new!(BN382Fq, BigInteger384([15791776196425138106, 18050543454536645620, 4409269230443573299, 16052959955442985715, 17476738767950693842, 1162489713506798434])),
            field_new!(BN382Fq, BigInteger384([11906109974361529725, 15306795184983549380, 4155387310588880274, 6180416274510671964, 4426996410962730186, 756896158125999840])),
            field_new!(BN382Fq, BigInteger384([14181042564822222050, 701246605447797587, 3942336547730946105, 16518997589713930806, 11899361407177707139, 294911663167241463])),
            field_new!(BN382Fq, BigInteger384([8374086877179825251, 2264591464122127576, 9873033896736374641, 11963981873350666843, 12789539683783406511, 1129194589538380767])),
            field_new!(BN382Fq, BigInteger384([10318206452532065935, 926489713079204479, 8369752820101050575, 13314648291698513509, 3356859517339362616, 1701137969070502998])),
            field_new!(BN382Fq, BigInteger384([16232534956374544732, 6535672643691604194, 7003415902683306923, 3908950359395080501, 4066480981470549601, 2159266056435576849])),
            field_new!(BN382Fq, BigInteger384([15954235559928368471, 329174902064826244, 13693353038625206789, 4089766615010650733, 8549079267913927226, 771064911269106507])),
            field_new!(BN382Fq, BigInteger384([4268341007039309198, 10992358117702254955, 13950870182267914824, 16873933335657922640, 14052707451643584138, 2584392839730574502])),
            field_new!(BN382Fq, BigInteger384([16591735610660498492, 17781899935954572135, 16646937437426615184, 16885825544709802324, 1509988581114077405, 387939338750224824])),
            field_new!(BN382Fq, BigInteger384([6058309965966798452, 6644057444231284713, 2295830477868038201, 12217652189600751773, 5254159715186605416, 2507118322499639480])),
            field_new!(BN382Fq, BigInteger384([7702054529420740660, 10981409101497270706, 12686607366150108892, 2345022846441368089, 9581689281978686926, 720624324682027648])),
            field_new!(BN382Fq, BigInteger384([17510253810687593896, 14145824575746044092, 10439406438570740625, 865563262725095441, 15244168470577504021, 403307286253798802])),
            field_new!(BN382Fq, BigInteger384([3242933625238041304, 7516857600183387153, 14681761372990303868, 11821858222899815164, 2342338970153924341, 558069737956008935])),
            field_new!(BN382Fq, BigInteger384([11054445124335614716, 1117249899233913763, 15016770458216493461, 580943470034605788, 946313509698390707, 1144207461194235289])),
            field_new!(BN382Fq, BigInteger384([5108326149335296081, 916637417971728292, 12773431289048875076, 10663588607535394673, 5357114698443342084, 1859535361516593966])),
            field_new!(BN382Fq, BigInteger384([6039373128271587854, 17076503937395488110, 5607663320819645576, 12559403026424961008, 15340818881534855517, 1463233461074269187])),
            field_new!(BN382Fq, BigInteger384([3783571473052933352, 8178680838610435600, 9180592555174895913, 7714863233415873408, 457319677449427634, 1451651832847914870])),
            field_new!(BN382Fq, BigInteger384([11029316711968334702, 6447067670798736477, 18202456233245781046, 3751685162424601534, 13094455818198547884, 415023143900494])),
            field_new!(BN382Fq, BigInteger384([16476349059727283335, 6330408673109019023, 10585261604176662531, 3142395226077508802, 10945206475499651667, 731110813877675189])),
            field_new!(BN382Fq, BigInteger384([8394119228450382902, 12242987121659750678, 17811696895679494957, 1826213441048614140, 10286928280372045535, 33606947057438694])),
            field_new!(BN382Fq, BigInteger384([7579338831997647598, 10938359721409838789, 3620989515966661032, 12279287358576237610, 1732441136645988932, 631880799153210288])),
            field_new!(BN382Fq, BigInteger384([9614010446177306678, 140499958558297497, 8766236305310369876, 3371793938909224669, 1853584933707828749, 2315035167232930591])),
            field_new!(BN382Fq, BigInteger384([7669235534727065524, 14098755367771001900, 17471862328026666793, 2479192610632435840, 5147665581216066672, 1544540915203183068])),
            field_new!(BN382Fq, BigInteger384([14637716683142119407, 14595866956389954699, 3611601429733342267, 14475802025677109666, 15569512102882598511, 1253541964638507110])),
            field_new!(BN382Fq, BigInteger384([4861873046018910447, 14513869866199065053, 17908500805447214805, 2157190732543967413, 8159090070018505326, 1418105534948653812])),
        ],
        merkle_arity: 2,
    };

#[cfg(test)]
mod test {

    use algebra::{
        fields::bn_382::Fq, Field,
    };
    use crate::{
        crh::BN382FqPoseidonHash,
        merkle_tree::field_based_mht::parameters::{
            generate_phantom_merkle_root_from_magic_string,
            generate_mht_empty_nodes,
        },
        FieldBasedMerkleTreePrecomputedZeroConstants
    };
    use super::{
        BN382_DUAL_PHANTOM_MERKLE_ROOT, BN382_DUAL_MHT_POSEIDON_PARAMETERS
    };

    #[ignore]
    #[test]
    fn test_generate_bn382_dual_phantom_merkle_root(){
        let expected_root = generate_phantom_merkle_root_from_magic_string::<Fq, BN382FqPoseidonHash>(
            "This represents an empty Merkle Root for a BN382FqPoseidonHash based Merkle Tree."
        );
        assert_eq!(expected_root, BN382_DUAL_PHANTOM_MERKLE_ROOT);
    }


    #[ignore]
    #[test]
    fn test_generate_binary_bn382_dual_mht_empty_nodes() {
        let merkle_arity = 2;
        let max_height = 32;

        let empty_nodes = generate_mht_empty_nodes::<Fq, BN382FqPoseidonHash>(merkle_arity, max_height, Fq::zero());
        assert_eq!(empty_nodes.len(), max_height);

        let params = FieldBasedMerkleTreePrecomputedZeroConstants::<BN382FqPoseidonHash> {
            nodes: empty_nodes.as_slice(), merkle_arity
        };
        assert_eq!(params, BN382_DUAL_MHT_POSEIDON_PARAMETERS)
    }
}


