# This script is used to produce test vectors and is based on the sage script from https://extgit.iaik.tugraz.at/krypto/hadeshash/-/commit/7ecf9a7d4f37e777ea27e4c4d379443151270563
# Usage: sage permutation_deefr <S1> <S2> <S3>, where the <Si> are hex representation of the state field
# elements.

# Parameters of the x^5-Poseidon permutation M = 128 using the setup for the BN382 scalar field.
N = 1146
t = 3
n = 382
R_F = 8
R_P = 56
prime = 0x2404893fdad8878e71503c69b09dbf88b48a3614289b09012012246d2242412000000001800c18180000000000000001
F = GF(prime)

round_constants = ['0x1b2e3d7de9e4d64f71bd143f5afdd9bf086eb232209416c94cbd24753cfcd19da57fa7d54e7c9b8e127323a211ccd286', '0x0d9b70f7ac2559f464e521ca3788586f6b669eecf7c5035a78ce2aa2bc942a5ff4e488fb71dc9319b4f19cd5cf7a7a42', '0x004ef6668822e796f7e35c61451b6cc1a2772d3700f97c0a0151a69e009a084cb244d0b97edfb12a35373bdaae2a1a6c', '0x2099f5206b789bbfc9eae143a83bd7b75518683632ab6dfd823f64708cde08a6382f83fb91e88cda0376c0ae08a4332d', '0x1f9506b4670e2a30e6692ae4c47c7382ddffca674d25ce3c385356066ef29d1dcecc5be5405f0263fd9a1275a0e264a9', '0x1e99f41f8f33b39fda45b56f20d96a227b580cb7dfe0d21373ae778b8d9bbc6bbb2293e23ae659c9b00136417fcad4f3', '0x06729def6dd37df6f8cb2bbccbb48a19165f6e378881e3b13062157f43c6790140796f0a1592f87bb7e98755389ef7c5', '0x2011146a62d93b7d46903839c62dbaa237e051bd0aeff12991c64b47358566c8835411528e166e5700565e752590ab9b', '0x1fcacac3f261c3e57ed78e815913a3f5a10dc1548183ad3978be4cfeaf662c47bd08b6741d4f2b5ccbc1de27df257cc2', '0x12191670127cfb34412000baa1aa9dff8fb4c6adeaa7a72784cf805fea85011a88a77c007291029560bffbcee08c301a', '0x01d42c10a1d9972a484db7b8625d71184c33d5d8e1e7491c6500b6e3a274e08a39dfedb40f87f5aa4a9fe38feae31b22', '0x21c5dd68abdd5dd87439fd5409bbe7a3d4f253dcbd866d033fee17376417765836fde4ea2f19b6f8bd6544094865a3dd', '0x0ffdfa68a811cb4f86f4c91496488fc7107dc199c78e4685dc04af5a35fe99985f9de24e209bd5bff53fa5df9bd93938', '0x11681d1ff151ac1c307fc3d910279b12811eecb7d7020c5ec20de2281ab0461ff572ef07d10fdc919af6f0686e7efa25', '0x1b27731f679afb646da16da1acfc642b5717cc0dccb85b5de08b08a0988f481fa1006bc4200fb82efcc39f36dbc3355e', '0x18eca22295aa0e1360c73a597e340a33c61600da84d0879f266c4c4f61d8107f1e063acd855ae4d01385f2ac658944d8', '0x1d15518c3e1aceaa9b8a40e7de64b28268e27f9b1a0246f2e9323103bf8f19e48443113d9675dbde8f290e14d425dad1', '0x13a8b8cc856ec666dd13311a9f6ad07aadba8dc9508a60a19c175a85b3ac6d892fece2527cf99bc3b5bae4c78097773b', '0x0cb48f1941f9bcd4368149b74ff62d3ad116d517fb5fa1413cb1801c2f701b7664bcbe843a230aadf93ca10c4f143724', '0x07e112eb6647de85b0788d26c43c732b2bfb3e140913b3a8ca5b2ed29ecbc06e009807d2ad85a24ebf2f44a43e20b88d', '0x02ed9d9b7be32a3af8f8981861144c6acfafa464e4e221d86f5050fdeb7f823780cd6875cb59ab42c7f69615e9fb6a96', '0x204274ca2919c9ca403aaa321151f6aba8c6d729483d797a6b80942b6bbca934ec6efcdebcb48b942a35fada5125d91a', '0x12302a9f23b0b6c3aee6964c96a69b7e1936387aa08cded6df13557847fe646ea11acce096c030b2f23a65383297a14c', '0x1f67ff059f98ad68010b105771b6111113ae2143df21c4bce1beabba1d02e5e0963394b03fffd5519ddf8cd7a5ff5ca7', '0x1d0eee346871c208b09289335c23ad05ea3e450c6a7c52eaaab8129a95914fffab0b65fb535f517f075bd3f5663bb170', '0x0d6c896fce0bd5468c7fdf16c8ed62b241d5e77f11a9e4bae5ef0c93138723e13ebde577c545b52a3bab84e7551641ae', '0x1c6c6e41b6ccea702ae864040498a1840ea58df9abf5e9de9ebad63bbe9596400a14f77c67305cc3a0ea4baaaebd13a0', '0x0b0ffbb1574e4ae9df70480ea231a2f26901eb900715d47875325fa874c55d1e8db6e3acc1ffd2375a473c0d08b20c53', '0x188cd8bfbc17d7eae3877d37966e3b924ebd3c156653f6701e418c8b4301f8e5a99190fa1dad6976bf1c9f055806b84f', '0x039faaee00478fdcecda846c64163d58b3b81db44af4af79e2fa33794ab95e1e3809b7670c4cb72b9cbc021fdcfe814e', '0x11d5321c089e622446aafd526144bf71c70aa30412b9e656271d7c96c308beaccbed947fed5e6635d85c49184866818d', '0x0c6787765eb5042258761ac61213893315e1de5a9bfd35f7d2a31adde28079040b25adc4086c93f24602d767cb454c59', '0x003d342bbc9e5f941aee8a554e96b1a53ff46d668f3d22b1f87444442adda78fe815953ed834fc2cc7d8fc628babd2d5', '0x149cbd731d9403579f5d07e760d476e37efb1a423ac618184723691856f6d3fd32ce6ecc6025b9f56457b62be6093def', '0x076f96bd03afaa105f51f1d015fcf7d6014aa09d13415b8540f56e721b66c412da8f0cdf4048a59c1336188e06f81026', '0x23551d0d8bee17983d8a87e34ca24283f2c618f3eb30bed551a97edbf5b199fd99af9c972dbb7199514f51a61ec37eb6', '0x0fb206bbb333afcb1f7421611b4b73d372b5ed9a1582e43135ffca992997242c12b07b57ee52b1ec4e7977d0a68b41aa', '0x222f4f4a1fd67d99729f972e6b83a1f1a60141862c346158847f697ddf0268ddf00105576580dc5e9592ed5c5f445895', '0x0c8a6b8dc1f469523dd5d5a88056dce6c1af81d7fffa97306edeb106483073e6f6f742a1859cc7fb9b5536d21adb61c2', '0x1381aac6ef29a2568128733dc6db9377905a7f43cacfc7cb34a5bb1fcb4171cc7103dfb708a9747cd7e0b6cb2175bd1f', '0x0de148fdf2bdabbb548fbd173913563485bc365950b43b0f565a5cd4986804418e225fe6f6d14f2b710cfadf73b4cef7', '0x023adad069970f8543a9f343b07a4a2a4c16ddc2ea4eff66c604682c229985bce790e9fe11734a4218640cd8791bd66e', '0x04a2761fc31eb758b35bc3891f07ef720ccc4042e38c8a24d0297aa763abf8122a4687ff3b907d38cbc541662167c607', '0x045ffb698017e3f6d4a438904024196931b9376e9105d236b2d013526c45525a13cfb60608b47c3cce72912e141e1543', '0x1f9bbf8d5da4f9b258399bf2e22ecb10c9d94065a4d26460768d16348740372fa98927d1309e25612eb21907999ce3a0', '0x12a323d3c6879abd150083116ecbaa855d83b4f6d95cf21664174ae77f1e9954c74584659c85932e91f162901df9f74c', '0x19b6a583258a1792c0060b3fa7363661be0c2bc8911943e93701f37646297d0dc55f0766d577651b4badeac0fc903986', '0x0250a7bf52af335eec59810632637bb2b131c6d569dbcc7f9e4fcfdefd56195bfb2b54df325a81c172642fb9bed6a7c0', '0x139c2bce0bb056c3467f253099a5b803f37a3e5483e2fb1363665f86bfc722fc23628ae8d234e30b0a8083e95406cba6', '0x15b032821ab04183ad3743742bad1a43dc7af169ddbc20f30fd3bcdb217e6dd4855af64cc0cab15f4c7f58d2dcf2c87f', '0x121b838b5f396fc2aa9c884f01d90c28b36857abc672542703d7366189e6531a165a1d861f1c6daa8740cebc12d7064d', '0x0b03ce5f5af1c1a8d8d1ec587519eecc9618c4c6aaf07b1f60d68445f8c587eaf1aed4846273d44de9d99cfd425bebee', '0x07f6fee76ef4a22fa283c9f9f590e618ae89a4581d6e1ef480a8af65a463edd899b50d041c88e1445ec0ef6ca22286f2', '0x18ac80afa2703ce89a401fa2a37a56990ff33a9ebf01d02d0c3de8e72d460381ae165332cb58e43601fb9d2c22c25d8a', '0x22c1bb39de15cfeb3e1c6807adcbe567648d27ebe5b892be6e2d685d8e3a24e7a6deabac0d9464f1c8e380b4f834ba1d', '0x1086c76132ef6b404d5fb6a49a8d0a1e40dc30101cd9afa77fbc63b0b5c6fae220a40176c1cb18f85a47eeda68553ff0', '0x1ecff3ec1bad819776b8d8ca78217b2067deb0142433ecade2e74528662315ea3a9d61e337f53a7570159a7111a33e84', '0x209af6b95ad8058d6c7ac6c1877576ea19969b7bc93427b558df56c70b1fc26b340fe7ff88d01ce78b9feb6f022a8a52', '0x208de2f6293b454a2708c419ed7247aad8817074f8072e3a19e139cd10897dc8d20c0c546c293438f861efa223e5b6f0', '0x18b73d59c4ac16908cf65448652b3687cd9f0e9eeb29b5463f38b26f51565152b34307f1b20a213289679abfe712a1c6', '0x14522afc3dd3de38184207f4e6ad7c5604972cb6fe327b78adc35e78d74d3448c52bf9f1d0d0f426dc0e23ef568ec4dd', '0x1c39c7d823c34792a2f12f6eab1175bd0479de10488ff95da034a78588343a612b09e33764edc04684b721ed2535dc2a', '0x195cd75e13318c6554ce356a87c08366875b702b1a275f30df59c7b59389ea8345cdf56392b835eb1162406b4b432c8b', '0x137c726db8aa724e683e268925db49d11e1a3f7a726fa1bb679594f3533b072b603c2d6e53674d912ad63a49552dcab6', '0x1be16c60a0ed03c56c78f792a7677186dae8cc141846cf12aec40a72f5829957768b5c9ee5f280a5aca519643bcc87d4', '0x1a494fa4450504ab6228021843a5f8c8fed58a0db8f449f17b69f30d4ca78050460858e88f7443d4c19ca68d7ad5b36e', '0x0b08d66ee3086d31835d78ecb6c731b86b1c200c9888be72c9866cbd1b5fb45fa9035e30945f0315256efb64db8e1e17', '0x0faf5252d4dc9f7a886a662bc45ebde2a8dccc75be6c1ad6c6683faa154bc590ac86b0a7d274937b7f56f8117acde428', '0x01b08b17d0bdff761eaf30aba118e6c5ffebef85c85752a32fc99d64b50004f5beb10a55f688764378e7dd7f9d753cfc', '0x061a86384d9484d155ca3f69aa96ba82a5095ffb7e0c160eb96928a0ff8fe382ae1ac37869749c12d7be561f34825e60', '0x0dbea8877bdba885b11395b647985e535978a324d031aade9c21d7a384f10b624fc2390f869a0aa3b25d5974a895b7cb', '0x0202ce78b371e665d663a4f577ce0ec70ee5d490b3ce6053e4ce2eff0b97b3ddb0eb2df916b30127e2dda23fbac2a7f4', '0x0ff20abe74b5feb595a8871ea7672acc4724602f14f2d12e4176617a64c3b6e7050054d71e3f8b114b15afd2c6058efa', '0x0f203681014c6af7100ecf330f4df80d56a84211d46fbe54c4385da9d2551eea55060805820c10756b63389f85ef94b5', '0x0d9ee45db75a75f211dfcadaec49ce7f2e1676310b56249119adbcebbeb337e491ea1f09507cd4b041923bb0dd14f803', '0x09454e921b23d43ab08d781c2d8cb4625600dbbc55a7692a0970a349eaf967bdf87c213dab750a3940b4e4f25912071b', '0x0f1f14d99b2251610150a6c413ce349ce488005625b7b18186618db6dfcbc98961ec1093125103ed9802bc341acf10da', '0x21066fbbe2261a8ad595ee02a0d1e47a0ac688d7ce0a60f2b877f135ae48f82f1aabf107165595f5aba09b1a7617ce1d', '0x2201693465ea1dd850c2c67c17acb20ea236f28d0f04885b6334ad2d33229995ce0e08cff107198f1ac23e6ba4f87712', '0x1a975ec6a2f7b42941550efa4874525a2a7e9d300504a6866f102482d81bcefd7d1ed9cf206277559bfe2ad329c85d93', '0x232481866f13f90d878aaf259e02d3ba5b75f339fabfc2baec5f87ddc2434bfe28108620a690f03afd112926a6bae4ab', '0x043f5b356035027a59eeb8a337b5af322a96a662fa29d839318d4824a9d2e56266c53994b510223bfc9195a4124bddf1', '0x0a4adf5b7b45675249b124e1e5194e3eb931dffb49f25f856eb5980ceeef534e22948ecd9a503e7e7a92dc4562873a04', '0x03ec899221c468cf9877886032f2b6f51bb0e3b63abdd7e480ed3775ab8bccd8436c00ebb7f065a3ceb62156a8144cd3', '0x109270ff5731da37bf25c3b5faec13d4bb00aa502c25a7dafbefc464c9e3fca3da8f90a4dcaea18bdc7df853f6a7cc52', '0x0e0f421079e8278b829962fbb591a91073307c9a1d078702a2d5e332138de34285b090a5bcecd8bc9a61bc948bc271b3', '0x0b20b92b5a5be56328a894563e41a012eb19f3899085c4031cc4db8b400138b0b0459b9caea8ecb82ab53e88e6674e51', '0x1b8a906f0d033aad075d982fcf520e9c765074a1285e89f6e34cdf71c43546a5ab88df35cea9c0d543495e79f5ebd45a', '0x147a53266d26c17bf9b2a446e8285bfd432cb7fee2ad39e4a98b95f22e18c43f4e97fa91456a3b04e7e8cd3175364917', '0x1b5c544778c159328a3bbc184cefdf777e036fc8f706979946fea6cd2d8a17530505b6dc1692db7e0bf2bd2de4e05387', '0x09680d1614cdb7f9354b2d47234db8d43a8e8fed61d402ea126e0a09b3e0321562d30aa56141b016c8bdb5e697a1d5d0', '0x22cf92188779d86309de9c7a1e4562552e3155421e65ec16340edb29096de50e5cfb3dbe49f531de799d5aab4934548c', '0x014cd1db518df186a0321b0a73aa69b399e1389e78df9740331c4c9ac64c3507935e0c3ea2df0a1fd894cf5341c40605', '0x11349f6b122d8b40d8bc0a90a6e134925b6c3e753b3b2f20b82e71a47b6121407835b7e2f54f94f0ea33e50243699acb', '0x0290fe42378e103799766a36e6a0179e99ae7ba657e0ace5c6d0de4ae32f3fe83730916f509360f96ea2054176a354d1', '0x19ff8c48cf610ff2ac6bc9a53dc0a8832783c3a072016d23422ce90948288fd5493ac925ac3df07f78e7a25b6d10d0cb', '0x17ead60f1dfb2fe7d97100df9dd1556aa2c6286d80f83eaafed6f13eec01dd10240d1eb6ac4808833c541c9994e2bd7d', '0x23d076e59c4cb63d87f658f4e4a1eda41f84e3e9c83794f89b9cd84422f34412effca4aaba99cf30a8dc848bd35ab049', '0x0069e746298b6e0690fca5bf66f6f1d367544b94f51375b34f5f50f51185b56fb2ec00214fac414391831cfb246c031c', '0x1017499e4cc3fc58d5792af8d4b9f0e243829cbb51b36ff454b9c741b97a46a1d7559cbc616f4e17e8323b053eb855dd', '0x1f8210a9695bda0958dc27a57fd88de11bf4fcf3ce5cebcbcaf32e4a1ffb738482aa4b17d55a754f1bb500a91a983caf', '0x1427ba6b7de5551037df972a33690ab6afdbb104b05e01dece3300f938b303e49326d19dbba62a3da1357548b3acd77d', '0x0f5ad6b801168c0f4874f9433814d96a82a90ba494dd4a85fe81e6df7783737ac11168c5634fa4f87c85d648aa5ce629', '0x18ccc64a2bad9e05e7ec236de148fc2190aeb2f53bfde5a5dfaacd087f1ab9cdcceb41d5db2ba39154ab8d1fdcb7420f', '0x00c662c96805ff39a3dcbf0823af95e26dc083ba4b69d4350d27ae69fae7bf0a35dc5eb1ae917fd5d3c49140e5b9a5b9', '0x15b985f285897210c7eef472eb8d2843530f815943a63d0609adb01b294f5d691e16a88ee38164c8aa82cb7c91784930', '0x1647b5e3fcf1c39288a79eb5cb99bd27d9bec41143c6b6417c2871f06765b5213bdbc8a691fede3b8be3758131316daf', '0x19f5d67d71e8d515ed4515b98bbfe6c625e2493b86b4b8832cdd905504ca3c31e5b2da18a1cfeb92908b7537b9699d04', '0x233fc908356053276a1b2d969a942ada3f4abe8a7fca7b97dfe3ad588f60b8d3c0ec3aaaf70ab19a522c79d5c28a4ba8', '0x12332419b2ed3cbce7af3987902fa93001908a08bba5e562cdaa2489c6f794e7c8ba881dd8a3402a121b319abe496260', '0x191917b44686cbb2c375030df6d843d41eebe6c094aea70fe53062c21d92122fbd9ee7218cb9e29309caacf8df949f23', '0x19a43cd5f5ee72790d3432c64694c0ac0c0b90e618353216fa8c7f54147038992b86fc3054f8fbb1e1281dd14162db03', '0x01177b81270bb6b4c1728a5484b9ca1057c48816a40a80dd8330d45961e784e6b22d1e07eccf20c521d4292a73cb2e1c', '0x0300bd3c89fbdd5f98f72072aca11c37d6ea9ddc85e8676c7c93cab860ffe4655f24f26675edc9fcc3f40f48ca518f62', '0x05ee1eaea0af1e0c9ed1ec0322fb10d0f2981d95a24ef33842efd7aa48bf74c4eabb1f93d0854c27dc4805e16da33913', '0x1672027f4e29e39165aec55ca0ba32c8e37749889d98409b12143f799c16abef019ca26cc80137f9efef0efa9501b609', '0x23a81ebfaa2ad71d05dedb91f8d10d598f2417cdfdf7024e34d6f12fc1124dfb0fec1bcb4336b38d8c63ff5cf2473376', '0x1765f17e8893c9b8beb85e0a5c7d12594304a73ea5b0e10f96be16e3f690db780f487d038fea173ee09bed1d0296542d', '0x1a4d335d1217cdca51620efd02f0990daef9a69cee49a8b022434bd6c0dfd4e7383780545789f1243e084da06b60eebe', '0x20e6ed2a5806207bdd4cb8e84b2b2f5ee40aadfbe854451fdb001ffc5c9dff8df93370a56c3b04c5b7b20e19c01fc009', '0x164e4a97aa261278778cf3e6b39b7b8d49f1ff78c41c216e357366bcd9dc041f89dda7480bc7e4fa93b74cb74bb73c56', '0x1938f89c6a8cd855cea2f6e901ee1529b810e22867d20e7e6409b1e90e39d310128a08b13e2ff897690fc9a60f40c4c7', '0x0dc610073b238f858e42f96c0731f38226a781915dad797815046da5166e50fdcb988d7d6464409ee3c075f916ed2ea8', '0x148920f6648de4d7bb2b875b22a27ba5ca9664ab0138f5e6a89547e5fba7912f7d5e8a648b9e52ca334e1797ec60571b', '0x0fdef06d3819a3158dcb8cd39d35b4705dd9c4121796b2d51a2d3d50d4a372f53331d2a1218f9a21915b978bf0579a2d', '0x045235e93e6a8615ad7ca64084a97d7e8322df0a7f89d82739d5044536b7544f2866062aefafb52e82784ae0ea7420cb', '0x17111bfdfbfafb8eb4c0a6dfee99e31c732504f1facf27fb0f0c143f95bdf0058464c55dbad71ab508a279a018e99ac1', '0x0157baa1e4567d3ed748b0e946befab67a615e5c0f00a24b2c525e2285aba2cf69f303b46745df6e9ab8aef5faaaafe6', '0x0349e1dcaadd04f46af3f8e2cbcd8e1a8fc4bb90628ded7a97c6c4e1ab4891da055a9959308c48954b0df0ba4d750b13', '0x1eacbd1c12a2e9727dc58434c48f458b0d7c5e79ccfc13c7a82f17bec3b21a1c7532760cd5dea26ad9dd542f39a6023a', '0x123e9ab874e2a30b3850baa983a44a37a1e3fc8c439c7654320f27f50d28d5c7a947e2d5724b19cbd4769e9c0ec4cf36', '0x0a631b11f14e1ea923c52286482dfbc9054ebe756f155360740c4c0cbb9a57372b3b0d98ca167d0b71c384aa0bae6dac', '0x17e06bd103156e1b2c35cfc0e0457f2c25c4bacbb3f732dc5e9805535af8290634261fb1dedfc91343d5cfc1e98cc9bc', '0x13e05fe2d8acfb93dcdda7c5a8eb5af1010cb6453ccfc0304bffdad9c7b8d34f5e4d5b726d659890639d0f865fbad421', '0x070ac84af9e36c248c04ac5b8fd5990dc0dd41ac21288c3ea6780c48e7f0cb34833021d6a9345666e3ac0ce775ab8065', '0x177aea81e9a09d8d84cdf4d0f9e88b20f3bba37b9cc7eec2dd90b3d50910aa1a7fbb24e48556426c00db77e7255e1ade', '0x180c9eb85d1d229aea44cf1d5e3e28114b5fce5b030293d5a3f95e33f52a81a62fb843756c984d6f430b169441cb21e2', '0x0523d466cb9c7c45355c31164c20a8e57b3a2c9e646a16f802669dd3916b558f72c7748fd5882e72d390f77341ed4551', '0x202ae3745105898443033ec2ced8f043cad26feefd78de9ec1ccab375cbaebc07a7df0aa5713c02a4e05c43c0712bb6b', '0x00fc4d7afc5a9d272b9a64b616061373d950449db2e09e158eafa190036fa6ae4bb72ce5c2bf31a0d7105eba79660854', '0x0e3935c9b047226580e9e6416dd48b55be0fd093b91750bfde9f85919bc470f85620388790d4151712bfcfd94fa53af2', '0x23c6d1106ddc4ee2b53b69b517da1a40b99096780f73042073d1c6c64ca6fafb68e5d506adccdf861bc3847283dc6b5c', '0x18471bfb35ee6b5be17d83794576abee416616cf2ba6a1568315f564dc73fe80d2f8a315b08f2716818b86faf5cd9206', '0x0c79b80927911a9d001652f292fe6f957e242c52de99f0b31d81f5a2ec910ed2a74c42291c639211f4f43f16483790e1', '0x1bca2c24a083d38ab5787849d84739a82a0c25601544ef156cb279c71e87d10fbe526ad6c544dd88aac240e62d8c34d5', '0x1573afc35279c9e3f3e704686d9b3bb2d9fea1906246ed6ea24002f417a957200240e6cfe2b753d87ac6d0ca2fc6da9f', '0x1234858ed413c01a4d2e3d0801bb2733772734f403850e6a0a5b98922c686183548528a1e14c755fe2df5649cf87fccb', '0x20795483ff443bfa271c8be77bb6df8e9e3a251c12f1283e889d817b9e79f2a3da34435a28451db8d7ec3a12e06a8921', '0x1f0f8fe08c6b3b311f40ce6bab379f4bd95ca683882c3108f07d0abb13da76889751698ed835640b7d4baea0f0ea71b2', '0x02f172a156e0bb89c3be934fe02526b5583da8ae7cdc3dfdccf8320a1c151682fbc9d4b29c36374c4aff1d949eaf484f', '0x1733441609c8e19f1ffd07333ccd8943933743c094c66255d627d32c7968a11a5871c2ac9ee29b3e1f54fcaf065d54a3', '0x0f61cd8473b8db86b6809bbd7d22306897cf149634a548f9bb3c8ba8ceb1daa6aa410abe8aa06e5c2aeb1b4583eb8cb1', '0x08952339e07cfd87da458e2f27de36d3a7dae866e5f06f88213a4ab8595b00a2e75dd6155ae1891206b70b0244a5f418', '0x10693eb02269b696fc546c078dc03781969a4ae44df6c27856d7eeff4a6310b71564dfda7ac49fb8f9ad3602d467797a', '0x0e2d0f83d19ed39f64027a9476a1cf34fffd9a59e57be9d461ee54f83822e59a66efdd1869ee2e14a737215986cd72a1', '0x1dcc56ae1e8dbd79bf1da3078ef13ab72743abd909c90921b33aa28ac856892731ddf98aaf78f4d2889553429ac69dd9', '0x079468e3a3736db8a4098cc69a36409a0200a1d9ffde495fefebd499a8fb41af730e472bab999e184ac2280fcc9eaadf', '0x09d8fccb04dc1c6297906b366ddf5ef2098af90834b063ab906216416917090a7fea233eefdb7a597e247b70b77ee4b1', '0x006023e9ef2a12555e20d0197ec23efd19ab2e0af224791caa389683b986d64eae6b82f6e89e1807a4b6d585afa0ce73', '0x0f54c4230beb73ac6664fa2ad0e0e8bdc9d8220e601d40e17780efa22aa3e12ac6e56841d808696ab561adfcb5b9951b', '0x0c730f48d721bf13423d7e2fc52a9bd777ec1da105e43bc254d64b488319dc69874aa203c607adebb128fcaf68200ef8', '0x1f57ceada9b0a52917755ffa8f80f5c2684cf93a63d912ef8256e3b7626797e881ead48c7a3f6f3b4ce937c572dfc265', '0x1aab6a03ea45dd53b4707903b8b22ebd6da35f639a929d937acba8f244e7c3ec9ccfc8425ef52510a51b4d049342e8d8', '0x1c70d88b4659834c47394bd8808bde6dceb8ec9d12e7d9299e11729ef3e595dc0bb131ca850f60e4bf1e3576657b97cc', '0x1632c9ae51b80474d9552997252118fcd5b811250aecff65b484cdacda1f52979120cecfc0b586ae13af714d18993cfb', '0x0c26903e43f53eb31826a16b4e6a8f409bc0df923ce2e525b76e4d622ceb84abb16dd36c40b4ea85c45b3638a62a7508', '0x13c98a27474e9baaafb6a53c357fe40e62dcdac82db6335cade3483131171e025b92c9a62aa9e30bd7d513ff2d117600', '0x042d5ca286387243ffbb4e637b8b33df83091e09106e074fe848919d607a20a87cc29d12399804d54dd61a449c158244', '0x0f78e3c502ebd39c81925c6b4143e8a835965806d2f7f26e7525eb8dd2be72bd0e9ca115363278740db7f485b58b30ae', '0x10fdab17cf7a8d1ec6f329840056f2ecf36b8e89221e6ccbcfb8e214e53faca202b08129c441c99e1cdc1a5b5e5c3cd2', '0x194f75c9bdbceecf655634de1720c2950f722a65eaab50588fc669a297b44bc975e283575c6a529374416fb78dd4d827', '0x03df7e4afd8904381d90bd90d435aac8c35249412fe2e004b8f9c280418cf40ed052b9502b6d133fa8d8639e09d545b0', '0x11834bc006665102348df2aec0382e9be077520a66dacfbd8b08bcd7bbc410012511d069c41791100e4255e599e8ebc8', '0x10e54fd5d550fe4804ea6fe836fa0c8b22cb4c7916b0d98bbb433982d702744a646fdebfe9ea92f34b7abb491fae1482', '0x03031bc0759acd442b1ddf6e8b8fa935ce431f6dfd47add3afebca5c0c0e5a79b607f42910dcb770564f4cb7e47086e5', '0x061da5cbed03488a110971be8e4b339483056621b6f910382dc65e033f619718389b39d35af825c7f95bb33a6e2682b7', '0x007d6cf63df4526f59b0f327071dfd729ebacd93a7ad347d456be572455237198618a73139426b44bf6c5c8b1755837e', '0x1d17d965b8ac491552185564a98e1805d6593edd082797691eaa2d4d86a66faa18773bd71b243dbcb667278dc37655fa', '0x00b9b327eaff95739bf7c51a55ce13a90503f18aca63dc3800c51589b36683a3140893b0cdad617eeeae847c2791931a', '0x0ac73672c76452df2ff579c65068c625ed994705ddf50c2ffe70f88bee3e6db9ca842654215002ce8a19be67c6618598', '0x0eeda074360a400fae51d43f1580455a4612b2f2791ff2f5ca018091e29c5e73df310f62ef0304869b7ba4a73eec8a00', '0x04755b35e5bb5d7c987e5d9d78db2ea3d9d1667d87c6300c1c806007778199bcccd7776efbe8e29f10470526fee370b3', '0x22526a580b172231eb625e7f9862e311ab099c09bed19623bd9b31f719ef758597c6095f27c08d01a9f928d5c76d603a', '0x04afed4c5edab192fdf4dd7bc4d06060081042b3165d354ca9e08c22692a50e7b23fcab3a0623f124dccd4f75b6a676f', '0x20c93f2c7da584c67028c86162b150b4f58d22a983d47a03787956c7da7006be90a2fa2a71a85a4865013e787d29b860', '0x0b9c45fe3509159bd5ef302b72c4c48c89934815d7f8e3d826246db4fdeacb040d1caa8e666f53050d44833ce330e31f', '0x04cadf37e2c3dc9f5e252790e43587403ebf23119ab6d747d2aa55bae07431c3eb6b7a2cd2f74616f943c0df2d12ce81', '0x04ea84a20f76da391aeaa9696d561eef242e6de660089e7bb34936efa2424681bcdd341d3d185f352cb3a5dde144984d', '0x055af1e2a8fa2c6444d5fa8b1c459d825b327dce571883a9554d303aef960fadae73634dfb6a8c5bcec7edccde2db186', '0x10f9291f1f3ae914c59aa26a236862efa86e922c37f72cad85430e0abdee79ef3558ca2a4b7ef0410cd5beff4aaad638', '0x0b1f238ad367cef5771554a6129ab36d6b5810ff4a0a3071a6bf1700844e83b91f2dc7b33eb18f4f9ef046f15a178e6d', '0x11a0f538d2a62273e6dfd67597b7035f8a7d2f9d608480285cff3135c83bde4bdc906ea5a139e7d522e2cb4e0cf2bbe9']

MDS_matrix = [['0x088c2d4280780057ffcafe8bbbb4ea91f69f283eea1805281ede1aa654488c36865e58f3c3d85000cac40e9fa84416b5', '0x17f00adcd1da85cd41303f65704eaf4ef4b10041a9e2d8c792cfa009df11ec797c555c3d238a93a803acb453b90cb057', '0x0a5a51065bb82723d1928a2c096649010e080d00a2c4428fbea3f444d2906922cf3a422f1be90df3cef395dde4c0103c'],['0x23741c8a5536ad9a7c6920679761739126661c5e0e141440fad359315f40844a23bb2021522c0ee76db77b4221cc4761', '0x1f5536a07afa61dba46ea07f62c1782f794fbde79b89cc5a41834e9d979844cc942000cb660f4061c8ec5d1ecb2fc22e', '0x15c804f3f99088de93fd942437c7e21af1d9c0d562c1a276ace670413440c5109a0aa8162bfefa1328eb4015bdb3a264'],['0x239050b60e019b83415f6adf59efc5c60dddeafa2344db99b05c67bb0795c2b2f210291edb6ec1ba227036c721124e0d', '0x11a8f32b291eafe9457a5340243296417cde0c4a521666dbc39738aba96770c570a16b369890ca903330b97ba2247b9b', '0x189a3b2402fdfdf12cc664e550f6dd3bdf398269ef63da3aafedb87f1d8b1817c6e621f892c39f72bb2d8c2a59a52e19']]

MDS_matrix_field = matrix(F, t, t)
for i in range(0, t):
    for j in range(0, t):
        MDS_matrix_field[i, j] = F(int(MDS_matrix[i][j], 16))
round_constants_field = []
for i in range(0, (R_F + R_P) * t):
    round_constants_field.append(F(int(round_constants[i], 16)))

#MDS_matrix_field = MDS_matrix_field.transpose() # QUICK FIX TO CHANGE MATRIX MUL ORDER (BOTH M AND M^T ARE SECURE HERE!)

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / 4)) + 2 # +2 for "0x"
    print(["{0:#0{1}x}".format(int(entry), hex_length) for entry in words])

def print_concat_words_to_large(words):
    hex_length = int(ceil(float(n) / 4))
    nums = ["{0:0{1}x}".format(int(entry), hex_length) for entry in words]
    final_string = "0x" + ''.join(nums)
    print(final_string)

def perm(input_words):

    R_f = int(R_F / 2)

    round_constants_counter = 0


    state_words = list(input_words)

    # First full rounds
    #print("Full rounds: ")
    for r in range(0, R_f):

	#print("Step ", r)
	#print_words_to_hex(state_words)

        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(MDS_matrix_field * vector(state_words))

    #print("Partial Rounds:")
    # Middle partial rounds
    for r in range(0, R_P):

       	#print("Step ", r)
	#print_words_to_hex(state_words)

        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        state_words[0] = (state_words[0])^5
        state_words = list(MDS_matrix_field * vector(state_words))

    # Last full rounds
    #print("Full rounds:")
    for r in range(0, R_f):

	#print("Step ", r)
	#print_words_to_hex(state_words)

        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(MDS_matrix_field * vector(state_words))

    return state_words

# Parameters
if len(sys.argv) != t+1:
    print("Usage: <script> <S1> <S2> <S3>")
    print("each Si is the initial state's field element (in hex)")
    exit()

input_words = []
for i in range (0,t):
	input_words.append(F(int(sys.argv[i+1],16)))

output_words = perm(input_words)

print("Initial state:")
print_words_to_hex(input_words)
print("After permution:")
print_words_to_hex(output_words)

